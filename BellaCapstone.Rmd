---
title: "BellaBeat Analysis"
author: "Oladayo Seweje"
date: "2022-12-27"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## BellaBeat Analysis Capstone

This analysis is done for the google analytics capstone project for BellaBeat, a high-tech manufacturer of health-focused products for women. Bellabeat is a successful small company, but they have the potential to become a larger player in the global smart device market. The data set for this project is gotten from <https://www.kaggle.com/datasets/arashnic/fitbit>. This data set generated by respondents to a distributed survey via Amazon Mechanical Turk between 03.12.2016-05.12.2016. Thirty eligible Fitbit users consented to the submission of personal tracker data, including minute-level output for physical activity, heart rate, and sleep monitoring. Individual reports can be parsed by export session ID (column A) or time stamp (column B). Variation between output represents use of different types of Fitbit trackers and individual tracking behaviors / preferences.

#### ASK

In this phase of the analysis, these are the questions that I am trying to answer for the company to help take their marketing strategies to the next level:

-   How are Bellabeat devices being used?
-   What are the relationships between the fitness data that were collected?
-   What are some trends in smart device usage?
-   How could these trends apply to Bellabeat customers?
-   How could these trends help influence Bellabeat marketing strategy?

Business task: Help BellaBeat play it smart by analyzing the collected data and helping the executives make decisions on the marketing strategies that would result in an increase in sales data for the company and an increase in the health of the customers.

#### PREPARE

In this phase of the analysis, I am taking a quick look at the collected data and I am trying to figure how the data will be helpful in answering the questions stated above. First, I need to install the needed libraries and load the needed data frames:

```{r}
library("tidyverse")
library("here")
library("skimr")
library("janitor")
library("dplyr")
library("palmerpenguins")
library("lubridate")
library("rmarkdown")
library("magrittr")

dailyActivity <- read.csv("dailyActivity_merged.csv")
dailyCalories <- read.csv("dailyCalories_merged.csv")
dailyIntensities <- read.csv("dailyIntensities_merged.csv")
dailySteps <- read.csv("dailySteps_merged.csv")
sleepDay <- read.csv("sleepDay_merged.csv")
```

After taking a quick look at the data, I can tell that the files are .csv files and they are all organized in a long format. I can also see that the data was entered automatically because it was collected from a smart device.

#### PROCESS

Processing the data involves checking for errors, cleaning the data, transforming the data and making sure that the data is ready for analysis.

First, I checked the number of variables and observations each data frame and I also checked the headers and the first 6 rows too:

```{r}
head(dailyActivity)
head(dailyCalories)
head(dailyIntensities)
head(dailySteps)
head(sleepDay)
```

Then, I checked the number of individuals in each data frame:

```{r}
n_distinct(dailyActivity$Id)
n_distinct(dailyCalories$Id)
n_distinct(dailyIntensities$Id)
n_distinct(dailySteps$Id)
n_distinct(sleepDay$Id)
```

I had to make sure that they were no missing values in each data frame as this could affect the result of the analysis:

```{r}
sum(is.na(dailyActivity))
sum(is.na(dailyCalories))
sum(is.na(dailyIntensities))
sum(is.na(dailySteps))
sum(is.na(sleepDay))
```

Then I checked for duplicates:

```{r}
sum(duplicated(dailyActivity))
sum(duplicated(dailyCalories))
sum(duplicated(dailyIntensities))
sum(duplicated(dailySteps))
sum(duplicated(sleepDay))
```

I only found duplicates in the *sleepDay* data frame. The next thing to do is to start cleaning the data.

##### Cleaning the Data

First, I got rid of the duplicates in the *sleepDay* data frame then I checked to make sure that there are no duplicates:

```{r}
sleepDay <- sleepDay[!duplicated(sleepDay), ]
sum(duplicated(sleepDay))
```

I found issues with the way the time and dates were formatted. The dates and time were placed together. for my analysis, I will only be using the date so I cleaned the data frames accordingly by getting rid of the time and making sure that the date is in the right format:

```{r}
dailyActivity$ActivityDate <- mdy(dailyActivity$ActivityDate)
dailyCalories$ActivityDay <- mdy(dailyCalories$ActivityDay)
dailyIntensities$ActivityDay <- mdy(dailyIntensities$ActivityDay)
dailySteps$ActivityDay <- mdy(dailySteps$ActivityDay)
sleepDay$SleepDay = as.Date(sleepDay$SleepDay, format = "%m/%d/%Y")

sleepDay <- sleepDay %>% 
  rename("Date" = SleepDay)
```

#### Analyze

After cleaning the data, I can now begin my analysis. Firstly, the total number of minutes in a day is 1440 so all activity time should add up to 1440. I created a new column called "TotalMinutes" in the *dailyActivities* data frame and checked to make sure that there is no one greater or less than 1440.

```{r}
dailyActivity$TotalMinutes <- dailyActivity$VeryActiveMinutes + dailyActivity$FairlyActiveMinutes + dailyActivity$LightlyActiveMinutes + dailyActivity$SedentaryMinutes

sum(dailyActivity$TotalMinutes > 1440)

sum(dailyActivity$TotalMinutes < 1440)
```

Then I created a new data frame called "UsageCountPerDay" to check how many times the smart devices are being used each day:

```{r}
usageCountPerDay <- dailyActivity %>% 
  group_by(ActivityDate) %>% 
  summarise(NumberOfTimesSmartDeviceIsUsed = n())
```

I converted the dates to days of the week and I used a new data frame called "AvgDailyUse" to find out what days of the week the devices are being used the most:

```{r}
usageCountPerDay$DayOfWeek <- weekdays(usageCountPerDay$ActivityDate)

AvgDailyUse <- usageCountPerDay %>% 
  group_by(DayOfWeek) %>% 
  summarise(AvgNumOfTimesDeviceIsUsed = mean(NumberOfTimesSmartDeviceIsUsed))
```

I merged the *dailyActivity* data frame and the *sleepDay* data frame together to see the relationship between the total steps and the total minutes asleep. I then checked the number of distinct individuals in the data frame:

```{r}
sleepDailyActivity <- merge(dailyActivity, sleepDay, by = "Id")
n_distinct(sleepDailyActivity)
unique(sleepDailyActivity$Id)
```

I added the weekdays to the *dailyCalories* data frame and I then used the mean() function to figure out how many calories were burned on an average by each individual and on what days of the week the most calories were being burned by the whole group:

```{r}
dailyCalories$DayOfWeek <- weekdays(dailyCalories$ActivityDay)

dailyCalories %>% 
  select(Calories,
         DayOfWeek) %>% 
  group_by(DayOfWeek) %>% 
  summarise(mean(Calories))

dailyCaloriesAVG <- dailyCalories %>% 
  group_by(Id) %>%
  summarize(AvgCalories = mean(Calories))

dailyCaloriesDaysAVG <- dailyCalories %>% 
  group_by(DayOfWeek) %>% 
  summarize(AvgCalories = mean(Calories))
```

I did the same thing to figure out how many steps were taken on an average by each individuals and on what days of the week the most steps were taken by the whole group:

```{r}
dailyStepsAverage <- dailySteps %>% 
  group_by(Id) %>% 
  summarize(AvgStepTotal = mean(StepTotal))

dailyStepsDays <- dailySteps
dailyStepsDays$DayOfWeek <- weekdays(dailyStepsDays$ActivityDay)

dailyStepsDaysAVG <- dailyStepsDays %>% 
  group_by(DayOfWeek) %>%
  summarize(AvgStepTotal = mean(StepTotal))
```

I merged the Average daily steps and the average daily calories together to see the relationship between the amount of steps taken and the calories burned:

```{r}
AvgStepsAndCalories <- merge(dailyStepsAverage, dailyCaloriesAVG, by="Id")

AvgDays_StepsXCalories <- merge(dailyCaloriesDaysAVG, dailyStepsDaysAVG, by="DayOfWeek")
```

#### SHARE

Here are the visualizations from my analysis

```{r}
ggplot(data = sleepDay, aes(x=TotalMinutesAsleep, y=TotalTimeInBed)) + geom_point()+
  labs(title = "Total time in bed Vs. Total minutes asleep")
```

From the graph above, we can see that there is a positive relationship between the total time spent in bed and the total time spent asleep. This makes sense because the sooner you go to bed, the more time you have to sleep.

```{r}
ggplot(data = dailyActivity, aes(x=Calories, y=TotalSteps)) + geom_point()+
  labs(title = "Total steps Vs. Calories burnt")

ggplot(data = AvgStepsAndCalories, aes(x=AvgStepTotal, y=AvgCalories))+ geom_smooth()+
  labs(title = "Average calories burnt per day Vs. Average steps per day")
```

We can see from both graphs above that there is also a positive relation ship between the total steps taken and the total calories burnt. Also, on an average, we can see that the more steps you take, the more calories you burn.

```{r}
ggplot(data = sleepDailyActivity, aes(x=TotalMinutesAsleep, y=TotalSteps))+ geom_smooth()+
  labs(title = "Total steps Vs. Total minutes asleep")
```

Here we can see that there is no real relationship between the total steps taken and the the total minutes asleep. However, It does seem like the more steps taken, the less time was spent asleep.

```{r}
as_tibble(AvgDailyUse)

ggplot(data = AvgDailyUse, aes(x=AvgNumOfTimesDeviceIsUsed, y=reorder(DayOfWeek, +AvgNumOfTimesDeviceIsUsed)))+
  geom_bar(stat = "identity", alpha = 0.8)+
  labs(y= "Day of the week", x= "Avg number of time device is used", title = "Day of the week Vs. Avg number of time device is used")
```

We can see from the table and graph above that the devices are being used mostly on fridays and saturdays but the margin is not that much.

```{r}
as_tibble(AvgDays_StepsXCalories)

ggplot(data = AvgDays_StepsXCalories, aes(x=AvgCalories, y=reorder(DayOfWeek, +AvgCalories), fill=AvgStepTotal))+
  geom_bar(stat = "identity", alpha = 0.8)+
  labs(y= "Day of the week", x= "Average calories burnt", title = "Day of the week Vs Avg calories burnt") 
```

From this table and graph above that Saturday and Tuesday seem to be the most active days for the users. Those are the days where the most steps are being taken and the most calories is being burned.


#### ACT

* BellaBeat devices are being used mostly on weekends (Friday and Saturday) so I think more resources should be placed into generating adverts for those days. A movement can also be started to push the users to use the devices more during the week.

* Some users of the BellaBeat devices do not wear the devices to bed. More resources should be place into creating a movement for users to put on their devices before going to Bed.

* BellaBeat customers will see that they will burn more calories when they increase the number of steps they take every day.

* Saturdays and Teusdays are the days when the most steps and taken and the most steps are being taken and the most Calories is being burned. This insight can also be used to create a marketing strategy to get the users to move more during the week and burn more calories.

* The users that wear their devices to bed and spend more time in bed will see that they spend more time asleep. This insight can also be used to create a marketing strategy to get new customers to buy the product and get more exsiting users to use the product while in Bed.

